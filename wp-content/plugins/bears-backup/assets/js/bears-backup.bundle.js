!function(e){var a={};function t(s){if(a[s])return a[s].exports;var o=a[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=a,t.d=function(e,a,s){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var o in e)t.d(s,o,function(a){return e[a]}.bind(null,o));return s},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=1)}([function(e,a){var t=jQuery.noConflict();e.exports={_async:e=>new Promise(function(a,t){e.call(this,a,t)}),_request(e){var a=t.extend({type:"POST",url:bbackup_object.ajax_url,data:{},success:function(){},error:function(e){console.log("error: "+e)}},e);return t.ajax(a)}}},function(e,a,t){"use strict";t.r(a);var s,o;s=window,o=jQuery,ELEMENT.locale(ELEMENT.lang.en),s.bbackup_helpers=t(0),o(function(){new Vue(function(){var e=jQuery.noConflict();return bbackup_object.ajax_url,{el:"#bbackup-backup-panel",data:()=>({backup_data:[],sort_data:{prop:"name",order:"descending"},step_bar_conf:{space:200,active:0,process_completed:0},table_bbackup_loading_st:!1,process_type:"",ajax_handle:!1,row_in_process:{},new_folder_backup:"",package_import:!1,bbackup_upload_filelist:[],fullscreenLoading:!1}),created(e){this.LoadBackupData()},watch:{"step_bar_conf.active"(e){var a=this;if(""!=a.process_type)switch(a.process_type){case"backup":e>=4&&setTimeout(function(){a.process_type=""},5e3);break;case"upload":e>=3&&setTimeout(function(){a.process_type=""},5e3)}}},computed:{style_process_completed(){return{width:this.step_bar_conf.process_completed+"%"}}},methods:{TableRowClassName(e){var a=[];return this.new_folder_backup==e.name&&a.push("is-new-row"),e==this.row_in_process&&a.push("is-process-row"),a.join(" ")},DeleteItem(e){var a=this,t=e.name;this.row_in_process=e,window.bbackup_helpers._request({data:{action:"BBACKUP_Ajax_Handle",handle:"BBACKUP_Delete_Folder_Backup",params:{backup_folder:t}},success(e){console.log(e),"OK"==e.st?(a.$notify({title:"Success",message:e.message,type:"success",offset:100}),a.LoadBackupData()):a.$notify.error({title:"Error",message:e.message,offset:100})}})},DownloadBackup(e,a){var t=this;this.row_in_process=e,window.bbackup_helpers._request({data:{action:"BBACKUP_Ajax_Handle",handle:"BBACKUP_Download_Backup",params:e},success(e){Vue.set(t,"row_in_process",{}),e.success?window.location.assign(e.data.backup_path_file):console.log("fail!!!")}})},LoadBackupData(){var e=this;this.table_bbackup_loading_st=!0,window.bbackup_helpers._request({data:{action:"BBACKUP_Ajax_Handle",handle:"BBACKUP_Load_Backup_Data"},success(a){e.table_bbackup_loading_st=!1,e.backup_data=a}})},StepDisplay(e){return e==this.process_type},BackupData(a){var t=this,s=0,o="";this.process_type="backup";var r=[{handle:"BBACKUP_Backup_Database",params:{package_import:t.package_import},On_Start(){t.step_bar_conf.active=0,t.step_bar_conf.process_completed=0},On_After_Success(e){o=e.bk_folder_name,r[s+1].params.bk_folder_name=o,console.log("Backup database!")},On_Error(){console.log("fail!!!"),t.$notify.error({title:"Error",message:"Backup databse fail!",offset:100})}},{handle:"BBACKUP_Create_File_Config",params:{},On_After_Success(e){r[s+1].params.bk_folder_name=o,console.log("Create file config.json!")},On_Error(){console.log("fail!!!"),t.$notify.error({title:"Error",message:"Create file config.json fail!",offset:100})}},{handle:"BBACKUP_Backup_Folder_Upload",params:{},On_After_Success(e){console.log("Backup folder Uploads!")},On_Error(){console.log("fail!!!"),t.$notify.error({title:"Error",message:"Backup folder Uploads fail!",offset:100})}},{ajax:!1,action(){setTimeout(function(){console.log("Backup success!"),t.step_bar_conf.active=4,t.step_bar_conf.process_completed=100,t.new_folder_backup=o,t.LoadBackupData(),t.$notify({title:"Success",message:"Backup success!",type:"success",offset:100})},2e3)}}],c=function(a){var o=e.extend({ajax:!0,action:"BBACKUP_Ajax_Handle",handle:"",On_Start(){},On_After_Success(){},On_Error(){}},a),n={NextStep(){c(r[s+=1])}};o.On_Start.call(null),1==o.ajax?window.bbackup_helpers._request({data:{action:o.action,handle:o.handle,params:o.params},success(e){"OK"==e.st?(o.On_After_Success&&o.On_After_Success.call(this,e),s+=1,t.step_bar_conf.active=s,t.step_bar_conf.process_completed=e.progress,r[s]&&c(r[s])):o.On_Error&&o.On_Error.call(this,e)}}):o.action.call(n)};c(r[s])},BeforUploadBackup(){this.process_type="upload",this.step_bar_conf.active=0,this.step_bar_conf.process_completed=0},SubmitUploadBackup(e){},UploadBackupSuccess(e,a,t){if(1==e.success){if(e.data.error)return void this.$notify({title:"Error",message:e.data.error,type:"error",offset:100,duration:5e3});this.step_bar_conf.active=1,this.step_bar_conf.process_completed=30,Vue.set(this,"bbackup_upload_filelist",[]),this.MoveExtractBackupFile(e.data)}},MoveExtractBackupFile(e){var a=this;window.bbackup_helpers._request({data:{action:"BBACKUP_Ajax_Handle",handle:"BBACKUP_Move_Extract_Backup_Upload_File",params:e},success(e){console.log(e),1==e.success?(a.step_bar_conf.active=2,a.step_bar_conf.process_completed=70,setTimeout(function(){a.step_bar_conf.active=3,a.step_bar_conf.process_completed=100,a.LoadBackupData(),a.$notify({title:"Success",message:e.data.message,type:"success",offset:100,duration:5e3})},2e3)):a.$notify({title:"Error",message:e.data.message,type:"error",offset:100,duration:5e3})}})},RestoreData(e){var a=this;e.name,a.fullscreenLoading=!0,window.bbackup_helpers._request({data:{action:"BBACKUP_Ajax_Handle",handle:"BBACKUP_Restore_Data",params:e},success(e){console.log(e),a.fullscreenLoading=!1,1==e.success?a.$notify({title:"Success",message:e.data.message,type:"success",offset:100,duration:5e3}):a.$notify({title:"Error",message:e.data.message,type:"error",offset:100,duration:5e3})}})}}}}())}),o(s).load(function(){})}]);
//# sourceMappingURL=bears-backup.bundle.js.map